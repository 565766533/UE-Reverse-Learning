# 单机 UE 游戏练习指引

> 仅面向线下/单机环境的技术研究。请遵循所在地区法律与目标游戏的使用条款，避免在联网或竞技环境使用任何修改。

本指南把仓库中的 8 个模块映射到“真实单机 UE 游戏”上的练习路径，帮助你在不破坏线上公平性的前提下，完成一次完整的偏移定位与功能实现。

---

## 1. 范围与准备

1. **选择合适的目标：**
   - 优先使用离线、可暂停的 UE4/UE5 单机游戏或 Demo。
   - 确认版本信息（Engine 版本、打补丁时间）并备份游戏可执行文件。
2. **法律与风险：**
   - 仅在个人本地环境实验，不联机、不影响他人体验。
   - 记录每次修改内容，养成“可回滚”习惯（如使用版本控制/复制游戏目录）。
3. **工具就绪：**
   - VS/clang-cl、Cheat Engine、x64dbg/IDA/Ghidra、ReClass.NET。
   - 来自本仓库的 `03-ReverseTools`（读写/Pattern Scan/Pointer Chain）编译为 CLI 工具，后续直接复用。

---

## 2. 映射仓库模块到真实流程

| 仓库模块 | 单机练习对应环节 | 输出物 |
| -------- | ---------------- | ------ |
| `01-BasicMemory` | 在 Demo 中练习结构体打印、Pattern Scan，确认指针链概念 | Demo 扩展笔记、指针链示意图 |
| `02-UEObjectSystem` | 根据真实游戏版本推测/验证 `UWorld`、`GNames`、`GObjects` 布局 | 一份字段偏移表（可用 ReClass 图） |
| `03-ReverseTools` | 将工具编译成注入器/外挂 CLI，负责读写、Pattern、指针解析 | CLI 使用文档、日志模板 |
| `04-CheatEngine` | 在目标游戏里完成 AoB 搜索、Pointer Scan、Auto Assembler 验证 | CE 任务记录、特征码列表 |
| `05-x64dbg` | 分析写入函数、调用栈，确认 Hook 入口 | 调试日志、函数伪代码 |
| `06-HookingTechniques` | 选择 VTable/Inline Hook，验证在真实游戏中是否稳定 | Hook 启停脚本、风险清单 |
| `07-RealWorldProject` | 将采集/过滤/渲染流程迁移到真实数据源 | ESP 数据流水线笔记 |
| `08-FinalProject` | 整合配置、热键、UI，形成实验用工具 | 单机辅助 Demo、配置文件 |

---

## 3. 实战步骤

### 3.1 侦查阶段

1. **识别 UE 版本**：通过 `strings Game.exe | rg "UE4"` 或 x64dbg 的 `PE Viewer` 确认版本号，对照 UE 源码寻找默认偏移。
2. **定位全局指针**：使用 Pattern Scan（`03-ReverseTools` 中的实现）寻找 `GWorld/GNames` 特征码。记录所有候选地址并写入表格。
3. **建立对象链**：借助 ReClass.NET 或自写 dump 把 `UWorld -> GameState -> PlayerArray` 等链路画出来（参考 `02-UEObjectSystem/UETypes.h`）。

### 3.2 数据验证

1. **Cheat Engine 验证**：通过数值搜索锁定玩家血量/坐标，用 Pointer Scan 与你的指针链互相印证。
2. **x64dbg 验证**：在血量写入函数设置读写断点，确认寄存器与堆栈参数，推导 Hook 位置。
3. **日志与快照**：把所有偏移、特征码、模块基址写入 `notes/TargetGame-Offsets.md`，配合 Git 管理历史。

### 3.3 功能实现

1. **读写功能**：先使用 `ProcessHelper` 提供的读写接口实现一个 CLI，输出玩家状态（血量、坐标、阵营）。
2. **ESP/辅助功能**：复用 `07-RealWorldProject` 的架构，把真实游戏数据接入 `Collect -> Filter -> Render` 流程，先在控制台打印，确认正确后再渲染。
3. **Hook/自动化**：若需要实时更新或改写函数，使用 `06-HookingTechniques` 的 VTable/Inline 框架；确保提供启停开关与原函数恢复。

### 3.4 安全与回滚

1. **监控崩溃**：为所有读写/Hook 添加异常处理与日志输出，崩溃时保存最后一次偏移和调用栈。
2. **版本更新**：当游戏更新时，按照 `docs/Advanced.md` 中的“偏移更新手册”流程重跑 Pattern Scan / CE / x64dbg 验证。
3. **清理残留**：练习结束后删除自动注入脚本，避免误触联网环境。

---

## 4. 练习 Checklist

- [ ] 目标为离线/单机 UE 游戏，已有可回滚的备份。
- [ ] 记录了 `UWorld/GNames/GObjects` 的真实偏移，并通过 CE/x64dbg 交叉验证。
- [ ] 编译并使用了 `03-ReverseTools`，具备 Pattern Scan + Pointer Chain CLI。
- [ ] 在真实游戏中完成“读取玩家状态 → 修改血量/速度”等至少 1 个功能。
- [ ] ESP/Hook 实验提供启停、日志与异常恢复方案。
- [ ] 所有实验代码、偏移、截图都保存在 `notes/` 目录或个人知识库中。

满足以上条目后，你就完成了一次完整的单机 UE 游戏逆向练习，可以继续挑战更多对象或把成果整理成教程。

---

## 5. 常见问题

1. **Pattern 在 Release 版本失效？**  
   - 使用更短、模块唯一的指令序列；必要时结合 RIP-Relative 计算实际指针。
2. **指针链频繁变化？**  
   - 优先通过 `GWorld` 等全局对象获取 Actor，再在运行时解析成员；不要硬编码绝对地址。
3. **Hook 导致崩溃？**  
   - 检查调用约定、寄存器保存、原函数指针是否正确；先在 Demo 中验证，再迁移至游戏。
4. **担心触发反作弊？**  
   - 仅在离线环境运行；保持最小权限（不注入驱动、不修改网络流量），实验结束后清理所有常驻进程。

---

## 6. 下一步

- 将成功的偏移/Pattern 整理为 `json/yaml`，供后续版本快速更新。
- 继续扩展 `07/08` 模块，使其支持加载外部配置、热重载 UI，逐步接近可复用的单机练习工具链。
- 如果需要编写教程或记录，请引用本指南并重申“只限单机练习”的原则。

